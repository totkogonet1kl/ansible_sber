
---
- name: Test connect
  hosts: all
  become: yes

  vars:
    source_file: ../index.html
    dest_file: /var/www/html


  tasks:

  - name: ping servers
    ping:

  - name: install apache2
    apt:
      name: apache2
      state: latest

  - name: start apache and enable
    systemd:
      name: apache2
      state: started
      enabled: true

  - name: copy html file
    copy:
      src={{ source_file }}
      dest={{ dest_file }}
      mode=0555
    notify: restart apache

  handlers:
    - name: restart apache
      service:
        name: apache2
        state: restarted
